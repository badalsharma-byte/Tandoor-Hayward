 document.addEventListener('DOMContentLoaded', () => { if (typeof gsap === 'undefined' || typeof ScrollTrigger === 'undefined') { console.error('GSAP or ScrollTrigger not loaded. Animations disabled.'); document.body.classList.add('no-animations'); return; } gsap.registerPlugin(ScrollTrigger); let lenis; if (typeof Lenis !== 'undefined') { lenis = new Lenis({ duration: 1.2, easing: (t) => Math.min(1, 1.001 - Math.pow(2, -10 * t)), smoothWheel: true, smoothTouch: false, }); function raf(time) { lenis.raf(time); requestAnimationFrame(raf); } requestAnimationFrame(raf); lenis.on('scroll', ScrollTrigger.update); gsap.ticker.add((time) => lenis.raf(time * 1000)); gsap.ticker.lagSmoothing(0); document.documentElement.classList.add('lenis'); } else { console.warn('Lenis not loaded. Smooth scroll disabled.'); } function splitTextIntoLetters(element) { if (!element) return; const originalContent = element.innerHTML; const lines = originalContent.split(/<br\s*\/?>/i); element.innerHTML = ''; const emphasisWords = ['AUTHENTIC', 'INDIAN', 'FLAVORS', 'FRESH', 'DAILY', 'WEâ€™D', 'LOVE', 'TO', 'HEAR', 'FROM', 'YOU']; lines.forEach((line, lineIndex) => { const words = line.trim().split(/\s+/); words.forEach((word) => { if (!word) return; const wordSpan = document.createElement('span'); wordSpan.className = 'word'; const cleanWord = word.replace(/[.,\/#!$%\^&\*;:{}=\-_`~()]/g, "").toUpperCase(); if (emphasisWords.includes(cleanWord)) { wordSpan.classList.add('emphasis'); } for (let i = 0; i < word.length; i++) { const letter = document.createElement('span'); letter.className = 'letter'; letter.textContent = word[i]; wordSpan.appendChild(letter); } const space = document.createTextNode(' '); element.appendChild(wordSpan); element.appendChild(space); }); if (lineIndex < lines.length - 1) { element.appendChild(document.createElement('br')); } }); } const header = document.querySelector('.header'); const menuToggle = document.querySelector('.menu-toggle'); const mobileMenu = document.querySelector('.mobile-menu-container'); const menuOverlay = document.querySelector('.menu-overlay'); const body = document.body; if (header) { window.addEventListener('scroll', () => { if (window.scrollY > 100) { header.classList.add('scrolled'); } else { header.classList.remove('scrolled'); } }); } function openMenu() { if (menuToggle) menuToggle.classList.add('active'); if (mobileMenu) mobileMenu.classList.add('active'); if (menuOverlay) menuOverlay.classList.add('active'); if (body) body.style.overflow = 'hidden'; } function closeMenu() { if (menuToggle) menuToggle.classList.remove('active'); if (mobileMenu) mobileMenu.classList.remove('active'); if (menuOverlay) menuOverlay.classList.remove('active'); if (body) body.style.overflow = ''; } if (menuToggle) { menuToggle.addEventListener('click', () => { if (menuToggle.classList.contains('active')) { closeMenu(); } else { openMenu(); } }); } if (menuOverlay) menuOverlay.addEventListener('click', closeMenu); document.querySelectorAll('.mobile-nav-list a').forEach(link => { link.addEventListener('click', closeMenu); }); document.addEventListener('keydown', (e) => { if (e.key === 'Escape' && menuToggle && menuToggle.classList.contains('active')) { closeMenu(); } }); const heroHeading = document.querySelector('.hero-heading[data-animate="true"]'); if (heroHeading) { splitTextIntoLetters(heroHeading); const heroTimeline = gsap.timeline({ delay: 0.5 }); if (document.querySelector('.hero-eyebrow')) { heroTimeline.from('.hero-eyebrow', { opacity: 0, y: 20, duration: 0.8, ease: 'power3.out' }); } const letters = heroHeading.querySelectorAll('.letter'); if (letters.length > 0) { letters.forEach((letter, index) => { setTimeout(() => { letter.classList.add('revealed'); }, index * 60); }); } if (document.querySelector('.hero-left')) { heroTimeline.from('.hero-left', { opacity: 0, y: 20, duration: 1, ease: 'power3.out' }, '-=0.5'); } if (document.querySelector('.hero-reviews')) { heroTimeline.from('.hero-reviews', { opacity: 0, y: 20, duration: 1, ease: 'power3.out' }, '-=0.7'); } } const aboutSection = document.querySelector('.about-section'); if (aboutSection) { ScrollTrigger.create({ trigger: '.about-section', start: 'top top-=20vh', end: 'bottom top+=80%', pin: '.about-content', pinSpacing: false, markers: false }); } const animatedHeadings = document.querySelectorAll('[data-animate="true"]:not(.hero-heading)'); if (animatedHeadings.length > 0) { const observerOptions = { threshold: 0.15, rootMargin: '0px 0px -50px 0px' }; const observer = new IntersectionObserver((entries) => { entries.forEach(entry => { if (entry.isIntersecting) { const letters = entry.target.querySelectorAll('.letter'); letters.forEach((letter, index) => { setTimeout(() => { letter.classList.add('revealed'); }, index * 50); }); observer.unobserve(entry.target); } }); }, observerOptions); animatedHeadings.forEach(heading => { splitTextIntoLetters(heading); observer.observe(heading); }); } document.querySelectorAll('video').forEach(video => { video.play().catch(err => console.log('Video play prevented:', err)); }); document.querySelectorAll('a[href^="#"]').forEach(anchor => { anchor.addEventListener('click', function (e) { e.preventDefault(); const targetId = this.getAttribute('href'); if (targetId === '#') return; const target = document.querySelector(targetId); if (target) { if (lenis) { lenis.scrollTo(target, { offset: -100, duration: 1.5 }); } else { target.scrollIntoView({ behavior: 'smooth' }); } } }); }); const newsletterForm = document.querySelector('.newsletter-form'); if (newsletterForm) { newsletterForm.addEventListener('submit', (e) => { e.preventDefault(); const emailInput = document.querySelector('.newsletter-input'); if (emailInput) { alert(`Thanks for subscribing with ${emailInput.value}! (This is a demo)`); emailInput.value = ''; } }); } if (window.matchMedia('(prefers-reduced-motion: reduce)').matches) { gsap.globalTimeline.clear(); ScrollTrigger.getAll().forEach(st => st.kill()); document.querySelectorAll('.letter').forEach(l => l.style.opacity = 1); gsap.set(['.hero-eyebrow', '.hero-left', '.hero-reviews'], { opacity: 1 }); } const floatingBtn = document.getElementById('floatingOrderBtn'); if (floatingBtn) { ScrollTrigger.create({ trigger: '.hero', start: 'bottom top+=100', onEnter: () => floatingBtn.classList.add('visible'), onLeaveBack: () => floatingBtn.classList.remove('visible') }); } const pickupCard = document.getElementById('pickup-card'); const deliveryCard = document.getElementById('delivery-card'); if (pickupCard && deliveryCard) { gsap.to('#pickup-card', { scrollTrigger: { trigger: '.order-delivery-section', start: 'top 70%', end: 'top 30%', toggleActions: 'play none none reverse' }, x: 0, opacity: 1, duration: 1, ease: 'power3.out', onComplete: () => pickupCard.classList.add('visible') }); gsap.to('#delivery-card', { scrollTrigger: { trigger: '.order-delivery-section', start: 'top 70%', end: 'top 30%', toggleActions: 'play none none reverse' }, x: 0, opacity: 1, duration: 1, ease: 'power3.out', delay: 0.2, onComplete: () => deliveryCard.classList.add('visible') }); } const promoPopup = { overlay: document.getElementById('promoPopupOverlay'), closeBtn: document.getElementById('promoPopupClose'), title: document.getElementById('promoPopupTitle'), message: document.getElementById('promoPopupMessage'), cta: document.getElementById('promoPopupCta'), config: { enabled: true, title: 'Special Offer!', message: 'Get 15% off your first online order! Use code: WELCOME15', ctaText: 'Order Now', ctaLink: 'order.php', delaySeconds: 5, schedule: { days: [0, 1, 2, 3, 4, 5, 6], startHour: 10, endHour: 21 }, showOncePerSession: true }, init() { if (!this.overlay || !this.config.enabled) return; if (this.config.showOncePerSession && sessionStorage.getItem('promoPopupShown')) { return; } if (!this.isWithinSchedule()) { return; } this.updateContent(); setTimeout(() => this.show(), this.config.delaySeconds * 1000); this.closeBtn?.addEventListener('click', () => this.hide()); this.overlay?.addEventListener('click', (e) => { if (e.target === this.overlay) this.hide(); }); document.addEventListener('keydown', (e) => { if (e.key === 'Escape') this.hide(); }); }, isWithinSchedule() { const laTime = new Date().toLocaleString('en-US', { timeZone: 'America/Los_Angeles' }); const laDate = new Date(laTime); const currentDay = laDate.getDay(); const currentHour = laDate.getHours(); const { days, startHour, endHour } = this.config.schedule; if (!days.includes(currentDay)) return false; return currentHour >= startHour && currentHour < endHour; }, updateContent() { if (this.title) this.title.textContent = this.config.title; if (this.message) this.message.textContent = this.config.message; if (this.cta) { this.cta.textContent = this.config.ctaText; this.cta.href = this.config.ctaLink; } }, show() { this.overlay?.classList.add('active'); document.body.style.overflow = 'hidden'; if (this.config.showOncePerSession) { sessionStorage.setItem('promoPopupShown', 'true'); } }, hide() { this.overlay?.classList.remove('active'); document.body.style.overflow = ''; }, setConfig(newConfig) { this.config = { ...this.config, ...newConfig }; this.updateContent(); } }; promoPopup.init(); window.tandoorPromoPopup = promoPopup; const marqueeTrack = document.querySelector('.testimonial-track'); if (marqueeTrack) { const marqueeContent = marqueeTrack.innerHTML; marqueeTrack.innerHTML += marqueeContent; if (window.innerWidth > 1600) { marqueeTrack.innerHTML += marqueeContent; } const marqueeTween = gsap.to(marqueeTrack, { xPercent: -50, repeat: -1, duration: 40, ease: 'linear' }); const marqueeContainer = document.querySelector('.testimonial-marquee'); if (marqueeContainer) { marqueeContainer.addEventListener('mouseenter', () => marqueeTween.pause()); marqueeContainer.addEventListener('mouseleave', () => marqueeTween.play()); marqueeContainer.addEventListener('touchstart', () => marqueeTween.pause()); marqueeContainer.addEventListener('touchend', () => marqueeTween.play()); } } }); 